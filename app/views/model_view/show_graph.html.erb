<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
  <body>
    <div>
      <h1>Graph</h1>
      <script src="http://code.highcharts.com/highcharts.js"></script>
      <script src="http://code.highcharts.com/modules/exporting.js"></script>

<!-- Trigger the modal with a button -->
      <button type="button" class="btn btn-info btn-lg" id="showModal" >Settings</button>

<!-- Modal -->
    <div id="myModal" class="modal fade" role="dialog">
      <div class="modal-dialog modal-lg">

    <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Modal Header</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="page" id="1">
          <div class="dropdown">
  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Dropdown button
  </button>
  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    <a class="dropdown-item" href="#">Action</a>
    <a class="dropdown-item" href="#">Another action</a>
    <a class="dropdown-item" href="#">Something else here</a>
  </div>
</div>
</br>
<div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Dropdown button
</button>
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
<a class="dropdown-item" href="#">Action</a>
<a class="dropdown-item" href="#">Another action</a>
<a class="dropdown-item" href="#">Something else here</a>
</div>
</div>
</br>
<div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Dropdown button
</button>
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
<a class="dropdown-item" href="#">Action</a>
<a class="dropdown-item" href="#">Another action</a>
<a class="dropdown-item" href="#">Something else here</a>
</div>
</div>
          <div class="form-group">
            <div class="checkbox">
   <label><input type="checkbox" value="" >Option 1</label>
 </div>
 <div class="checkbox">
   <label><input type="checkbox" value="" >Option 2</label>
 </div>
 <div class="checkbox disabled">
   <label><input type="checkbox" value="" >Option 3</label>
 </div>

 <form>
  <div class="form-group">
    <label for="email">Title:</label>
    <input type="email" class="form-control" id="text_input_1">
  </div>
  <div class="form-group">
    <label for="email">Subtitle:</label>
    <input type="email" class="form-control" id="text_input_2">
  </div>
 </form>
         </div>
       </div>
       <div class="page" id="2"  style="display:none;">
       <div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
 Dropdown 2.1
</button>
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
 <a class="dropdown-item" href="#">Action</a>
 <a class="dropdown-item" href="#">Another action</a>
 <a class="dropdown-item" href="#">Something else here</a>
</div>
</div>
</br>
<div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Dropdown 2.2
</button>
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
<a class="dropdown-item" href="#">Action</a>
<a class="dropdown-item" href="#">Another action</a>
<a class="dropdown-item" href="#">Something else here</a>
</div>
</div>
</br>
<div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Dropdown 2.3
</button>
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
<a class="dropdown-item" href="#">Action</a>
<a class="dropdown-item" href="#">Another action</a>
<a class="dropdown-item" href="#">Something else here</a>
</div>
</div>
       <div class="form-group">
         <div class="checkbox">
<label><input type="checkbox" value="" >2Option 1</label>
</div>
<div class="checkbox">
<label><input type="checkbox" value="" >2Option 2</label>
</div>
<div class="checkbox disabled">
<label><input type="checkbox" value="" >2Option 3</label>
</div>

<form>
<div class="form-group">
 <label for="email">Title:</label>
 <input type="email" class="form-control" id="text_input_1">
</div>
<div class="form-group">
 <label for="email">Subtitle:</label>
 <input type="email" class="form-control" id="text_input_2">
</div>
</form>
      </div>
    </div>
    <div class="page" id="3" style="display:none;">
    <div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Dropdown 3.1
</button>
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
<a class="dropdown-item" href="#">Action</a>
<a class="dropdown-item" href="#">Another action</a>
<a class="dropdown-item" href="#">Something else here</a>
</div>
</div>
</br>
<div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Dropdown 3.2
</button>
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
<a class="dropdown-item" href="#">Action</a>
<a class="dropdown-item" href="#">Another action</a>
<a class="dropdown-item" href="#">Something else here</a>
</div>
</div>
</br>
<div class="dropdown">
<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
Dropdown 3.3
</button>
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
<a class="dropdown-item" href="#">Action</a>
<a class="dropdown-item" href="#">Another action</a>
<a class="dropdown-item" href="#">Something else here</a>
</div>
</div>
    <div class="form-group">
      <div class="checkbox">
<label><input type="checkbox" value="" >3Option 1</label>
</div>
<div class="checkbox">
<label><input type="checkbox" value="" >3Option 2</label>
</div>
<div class="checkbox disabled">
<label><input type="checkbox" value="" >3Option 3</label>
</div>

<form>
<div class="form-group">
<label for="email">Title:</label>
<input type="email" class="form-control" id="text_input_1">
</div>
<div class="form-group">
<label for="email">Subtitle:</label>
<input type="email" class="form-control" id="text_input_2">
</div>
</form>
   </div>
 </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" id="confirm">Confirm</button>
        </div>

    <nav aria-label="pagination example" class="transparent-style">
      <ul class="pagination pagination-circle pg-blue mb-0">

        <li class="page-item active"  id="1">
            <a class="page-link" href="#">
              1
              <span class="sr-only">(current)</span>
            </a>
        </li>
        <li class="page-item"  id="2"><a class="page-link" href="#">2</a></li>
        <li class="page-item"  id="3"><a class="page-link" href="#">3</a></li>

      </ul>
    </nav>
      </div>
    </div>
  </div>
  <div id="container1" remote="true" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

<script>
$(function() {
  var graphData = <%= raw @graph.series[0][:data_array] %>;

  var currentPage = 1;
  var pageNumbers = [];

  $('#showModal').on("click", function(event) {
      $('.modal').modal('show');
      modalIsShowing = true;
    $('.page-item').each(function(event) {
      var itemId = $(this).attr('id');
      if (itemId == '1') {
        $('#' + itemId + '.page-item').addClass('active');
        $("div[id='" + itemId + "']").show();
      } else {
        $('#' + itemId + '.page-item').removeClass('active');
        $("div[id='" + itemId + "']").hide();
      }
      pageNumbers.push(itemId);
    });
  });

  $('#confirm').on("click", function(event) {
    var id = $(this).attr('id');
    if (pageNumbers.length > 0) {
      var intValueOfPage = parseInt(currentPage);
      if (intValueOfPage > 0 && intValueOfPage == pageNumbers.length) {
        //exit, save, change graph
        graphData = [
            ['Crops', 70],
            ['Legumes', 30]
        ];
        $('.modal.in').modal('toggle');
        currentPage = 1;
        pageNumbers = [];
      //  $('#container1').append("<%#= j render @graph %>");
      } else if (intValueOfPage > 0 && intValueOfPage < pageNumbers.length) {
        var previousPage = currentPage;
        var elementToHide = $("div[id='" + previousPage + "']");
        currentPage = (intValueOfPage + 1).toString();
        var elementToShow = $("div[id='" + currentPage + "']");
        $('#' + previousPage + '.page-item').removeClass('active');
        $('#' + currentPage + '.page-item').addClass('active');
        elementToHide.hide();
        elementToShow.show();
      }
    }
  });

  $('.page-item').on("click", function(event) {
     var previousPage = currentPage;
     var elementToHide = $("div[id='" + previousPage + "']");
     currentPage = $(this).attr('id');
     var elementToShow = $("div[id='" + currentPage + "']")
     $('#' + previousPage + '.page-item').removeClass('active');
     $('#' + currentPage + '.page-item').addClass('active');
     elementToHide.hide();
     elementToShow.show();
  });

    $('#container1').highcharts({
     chart: {
      // renderTo: "pie_chart"
       type: "<%= @graph.type %>"
       },
       title: { text: "<%= @graph.title %>" },
       xAxis: { type: "<%= @graph.x_opts[:type] %>"},
       yAxis: {
       title: { text: "<%= @graph.y_opts[:title] %>" }
    },
    series: [
      <% @graph.series.each { |serie| %>
        {
        name: '<%= serie[:name] %>',
        data: graphData
        //data: '<%#= raw dataValue %>'
        }
    <%  } %>
        ]
      });
   });
 </script>
    </div>
  </body>
</html>
